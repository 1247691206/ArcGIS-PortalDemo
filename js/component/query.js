define(["dojo/_base/declare","dojo/_base/lang","esri/toolbars/draw","esri/graphic","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/Color","esri/tasks/query","esri/tasks/QueryTask","dojo/text!esricdTmpl/query/queryPanel.html"],function(e,t,a,o,i,r,s,n,l,p,y){return e(null,{app:null,toolbar:null,constructor:function(e){this.app=e,this.bindDomEvents()},startup:function(){console.log("startup",this.app.config.itemInfo.itemData);var e=baidu.template(y,this.app.config.itemInfo.itemData);$("#queryDiv").html(e),this.initDraw()},bindDomEvents:function(){$("#queryDiv").delegate("button[data-drawType]","click",$.proxy(function(e){var t=$(e.currentTarget).attr("data-drawType");this.toolbar&&(this.app.map.graphics.clear(),this.toolbar.activate(esri.toolbars.Draw[t]))},this))},initDraw:function(){this.toolbar=new a(this.app.map,{tooltipOffset:20,drawTime:90}),this.toolbar.on("draw-end",$.proxy(function(e){switch(this.queryByGeometry(e.geometry),this.toolbar.deactivate(),e.geometry.type){case"point":case"multipoint":symbol=new i(i.STYLE_CIRCLE,10,new r(r.STYLE_SOLID,new n([0,0,0]),1),new n([0,0,0,.25]));break;case"polyline":symbol=new r;break;default:symbol=new s}var t=new o(e.geometry,symbol);this.app.map.graphics.add(t)},this))},queryByGeometry:function(e){var t=new l;t.returnGeometry=!1,t.outSpatialReference=this.app.map.spatialReference,t.outFields=["*"],t.geometry=e,t.distance=100;var a=$("#queryDiv [node-type=queryLayerSelect]").val(),o=new p(a);this.app.dataTable.showLoading(),o.execute(t).then($.proxy(function(e){this.app.dataTable.showQueryResult(e,a),console.log("results:",e)},this))},test:""})});